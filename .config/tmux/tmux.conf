# <<< theme-switcher <<<
set -g status-bg "#ffffff"
set -g status-fg "#000000"
# ==========================
# set -g status-bg "#181818"
# set -g status-fg "#ffffff"
# >>> theme-switcher >>>

# Change prefix to alt-m
set -g prefix M-m
unbind C-b
bind M-m send-prefix

set -g mode-keys vi

set -g default-shell /usr/bin/zsh
set -g history-limit 5000
set -g mouse         off
set -g focus-events  on
set -g set-titles    on
set -s escape-time   10  # faster command sequences
set -sg repeat-time  600 # increase repeat timeout

set -g base-index      1 # start windows and panes at 1, not 0
set -g pane-base-index 1

set -g set-clipboard on
bind p paste-buffer
bind -n M-p copy-mode
bind -T copy-mode-vi v        send-keys -X begin-selection
bind -T copy-mode-vi C-v      send-keys -X rectangle-toggle
bind -T copy-mode-vi y        send-keys -X copy-selection
bind -T copy-mode-vi u        send-keys -X page-up
bind -T copy-mode-vi d        send-keys -X page-down
bind -T copy-mode-vi M-u      send-keys -X page-up
bind -T copy-mode-vi M-d      send-keys -X page-down
bind -T copy-mode-vi [        send-keys -X previous-prompt
bind -T copy-mode-vi ]        send-keys -X next-prompt

bind -n M-h select-pane -L
bind -n M-l select-pane -R
bind -n M-j select-pane -D
bind -n M-k select-pane -U

bind -n M-C-l split-window -h -c "#{pane_current_path}"
bind -n M-C-j split-window -v -c "#{pane_current_path}"

# The following do noT work for whatever reason:
bind -n M-C-k split-window -vb -c "#{pane_current_path}"
bind -n M-C-h split-window -hb -c "#{pane_current_path}"

bind -n M-T rotate-window

bind -n M-t new-window -c "#{pane_current_path}"

bind -n M-0 select-window -t 0
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5
bind -n M-6 select-window -t 6
bind -n M-7 select-window -t 7
bind -n M-8 select-window -t 8
bind -n M-9 select-window -t 9

bind -n M-[   select-window -p
bind -n M-]   select-window -n
bind -n M-tab last-window

# tmux, for whatever reason, does not have an easy way to swap panes directionally
# Some LLM wrote this. I do not care enough to read it:
bind -n M-H run-shell "if [ \"$(tmux display-message -p '#{pane_at_left}')\" -ne 1 ]; then tmux select-pane -L; tmux swap-pane -s '!' -t '$TMUX_PANE'; tmux select-pane -t '!'; fi"
bind -n M-J run-shell "if [ \"$(tmux display-message -p '#{pane_at_bottom}')\" -ne 1 ]; then tmux select-pane -D; tmux swap-pane -s '!' -t '$TMUX_PANE'; tmux select-pane -t '!'; fi"
bind -n M-K run-shell "if [ \"$(tmux display-message -p '#{pane_at_top}')\" -ne 1 ]; then tmux select-pane -U; tmux swap-pane -s '!' -t '$TMUX_PANE'; tmux select-pane -t '!'; fi"
bind -n M-L run-shell "if [ \"$(tmux display-message -p '#{pane_at_right}')\" -ne 1 ]; then tmux select-pane -R; tmux swap-pane -s '!' -t '$TMUX_PANE'; tmux select-pane -t '!'; fi"

bind -n M-< swap-window -t -1 \; previous-window
bind -n M-> swap-window -t +1 \; next-window

# Enter Resize Mode
bind -n M-r switch-client -T resize_mode
# Resize Mode Bindings (Action + Re-trigger Mode)
bind -T resize_mode h resize-pane -L 5 \; switch-client -T resize_mode
bind -T resize_mode j resize-pane -D 5 \; switch-client -T resize_mode
bind -T resize_mode k resize-pane -U 5 \; switch-client -T resize_mode
bind -T resize_mode l resize-pane -R 5 \; switch-client -T resize_mode
# Exit Resize Mode
bind -T resize_mode Escape switch-client -T root
bind -T resize_mode Enter  switch-client -T root

# The strip at the bottom containing tabs and time
bind -n M-\\ set -g status
if-shell "[[ $(tmux lsw | wc -l) -le 1 ]]" 'set -g status'
set -g status
set -g status-left     ''
set -g status-right    '%a, %b %d %H:%M'

# RANT: tmux has the ability to show time but does not update it the right way.
# The time has to update once every one minute, as close to the minute mark as
# the OS scheduler allows. tmux does not do it correctly: It merely refreshes
# it at a fixed rate, starting when it is launched. This means that if tmux is
# launched at 00:00:59.999, and it updates it every minute, then from 00:02:00
# to 00:02:59.998, tmux will say 00:01. The default itself is idiotic: It
# refreshes it every 15 seconds for no reason (which also implies that you see
# the wrong time for up to 15 seconds). The civilization (or at least the part
# that enjoys and/or whose job it is to make tools that other people can use to
# do their job) has forgotten how to update something as simple as time. No,
# the CPU can never get good enough to handle unnecessary refreshes: It will
# always draw power to do it.
#
# The only use case I have for tmux is to run it in the linux console. If I
# have a display server, I will just use kitty, which is a proper superset,
# assuming we ignore super-unlikely-to-ever-be-useful features like session
# persistence: I will never care about which directory I was in when my ssh
# connection broke (which has never happened). If there's a critical process,
# there are better ways to run it than to rely on tmux and/or the shell not
# crashing.
set -g status-interval 60
